<div class="cabins-container">
  <div class="cabins-header">
    <h2>üè† Moje Vikendice</h2>
    <p>Upravljajte va≈°im vikendicama</p>
    <div class="header-actions">
      <a [routerLink]="['/owner/new-cabin']" class="btn btn-primary">
        ‚ûï Dodaj novu vikendicu
      </a>
    </div>
  </div>

  @if (isLoading) {
    <div class="loading">Uƒçitavanje vikendica...</div>
  } @else {
    <div class="table-container">
      <table class="cabins-table">
        <thead>
          <tr>
            <th>Naziv</th>
            <th>Lokacija</th>
            <th>Usluge</th>
            <th>Cena leto</th>
            <th>Cena zima</th>
            <th>Ocena</th>
            <th>Akcije</th>
          </tr>
        </thead>
        <tbody>
          @for (cabin of cabins; track cabin._id) {
            <tr>
              <td class="cabin-name">{{ cabin.name }}</td>
              <td>{{ cabin.location }}</td>
              <td>
                <div class="services-list">
                  @for (service of cabin.services.slice(0, 2); track service) {
                    <span class="service-tag">{{ service }}</span>
                  }
                  @if (cabin.services.length > 2) {
                    <span class="more-tag">+{{ cabin.services.length - 2 }}</span>
                  }
                </div>
              </td>
              <td class="price">{{ formatPrice(cabin.priceSummer) }}</td>
              <td class="price">{{ formatPrice(cabin.priceWinter) }}</td>
              <td class="rating">
                <div class="stars">{{ showStars(cabin.averageRating || 0) }}</div>
                <div class="rating-text">{{ (cabin.averageRating || 0).toFixed(1) }}</div>
              </td>
              <td class="actions">
                <button [routerLink]="['/owner/edit-cabin', cabin._id]" 
                        class="btn btn-edit btn-sm">
                  ‚úèÔ∏è Izmeni
                </button>
                <button (click)="deleteCabin(cabin)" 
                        class="btn btn-danger btn-sm">
                  üóëÔ∏è Obri≈°i
                </button>
              </td>
            </tr>
          } @empty {
            <tr>
              <td colspan="7" class="no-data">
                Nemate nijednu vikendicu. 
                <a [routerLink]="['/owner/new-cabin']" class="add-link">Dodajte prvu vikendicu</a>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>

    <div class="results-info">
      Ukupno vikendica: {{ cabins.length }}
    </div>
  }

  @if (cabinToDelete) {
    <div class="delete-modal">
      <div class="modal-content">
        <h3>Potvrda brisanja</h3>
        <p>Da li ste sigurni da ≈æelite da obri≈°ete vikendicu:</p>
        <p><strong>"{{ cabinToDelete.name }}"</strong>?</p>
        <p class="warning-text">Ova akcija se ne mo≈æe poni≈°titi!</p>

        <div class="modal-actions">
          <button (click)="cancelDelete()" class="btn btn-secondary">Otka≈æi</button>
          <button (click)="confirmDelete()" 
                  [disabled]="isLoading"
                  class="btn btn-danger">
            @if (isLoading) {
              Brisanje...
            } @else {
              Obri≈°i
            }
          </button>
        </div>
      </div>
    </div>
  }

  @if (message) {
    <div class="message" [class.success]="message.includes('uspe≈°no')">
      {{ message }}
    </div>
  }
</div>